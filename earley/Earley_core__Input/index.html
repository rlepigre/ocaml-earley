<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Earley_core__Input (earley.Earley_core__Input)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">earley</a> &#x00BB; Earley_core__Input</nav><h1>Module <code>Earley_core__Input</code></h1><p>A module providing efficient input buffers with preprocessing.</p><nav class="toc"><ul><li><a href="#type">Type</a></li><li><a href="#reading-from-a-buffer">Reading from a buffer</a></li><li><a href="#creating-a-buffer">Creating a buffer</a></li><li><a href="#creating-buffers-with-a-custom-preprocessor">Creating buffers with a custom preprocessor</a></li><li><a href="#buffer-manipulation-functions">Buffer manipulation functions</a></li></ul></nav></header><section><header><h3 id="type"><a href="#type" class="anchor"></a>Type</h3></header><dl><dt class="spec type" id="type-buffer"><a href="#type-buffer" class="anchor"></a><code><span class="keyword">type</span> buffer</code></dt><dd><p>The abstract type for an input buffer.</p></dd></dl></section><section><header><h3 id="reading-from-a-buffer"><a href="#reading-from-a-buffer" class="anchor"></a>Reading from a buffer</h3></header><dl><dt class="spec value" id="val-read"><a href="#val-read" class="anchor"></a><code><span class="keyword">val</span> read : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char * <a href="index.html#type-buffer">buffer</a> * int</code></dt><dd><p><code>read buf pos</code> returns the character at position <code>pos</code> in the buffer <code>buf</code>, together with the new buffer and position.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char</code></dt><dd><p><code>get buf pos</code> returns the character at position <code>pos</code> in the buffer <code>buf</code>.</p></dd></dl></section><section><header><h3 id="creating-a-buffer"><a href="#creating-a-buffer" class="anchor"></a>Creating a buffer</h3></header><dl><dt class="spec value" id="val-from_file"><a href="#val-from_file" class="anchor"></a><code><span class="keyword">val</span> from_file : string <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></dt><dd><p><code>from_file fn</code> returns a buffer constructed using the file <code>fn</code>.</p></dd></dl><dl><dt class="spec value" id="val-from_channel"><a href="#val-from_channel" class="anchor"></a><code><span class="keyword">val</span> from_channel : <span>?&#8288;filename:string</span> <span>&#45;&gt;</span> Stdlib.in_channel <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></dt><dd><p><code>from_channel ~filename ch</code> returns a buffer constructed using the channel <code>ch</code>. The optional <code>filename</code> is only used as a reference to the channel in error messages.</p></dd></dl><dl><dt class="spec value" id="val-from_string"><a href="#val-from_string" class="anchor"></a><code><span class="keyword">val</span> from_string : <span>?&#8288;filename:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></dt><dd><p><code>from_string ~filename str</code> returns a buffer constructed using the string <code>str</code>. The optional <code>filename</code> is only used as a reference to the channel in error messages.</p></dd></dl><dl><dt class="spec value" id="val-from_fun"><a href="#val-from_fun" class="anchor"></a><code><span class="keyword">val</span> from_fun : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></dt><dd><p><code>from_fun finalise name get data</code> returns a buffer constructed from the object <code>data</code> using the <code>get</code> function. The get function is used to obtain one line of input from <code>data</code>. The <code>finalise</code> function is applied to <code>data</code> when the end of file is reached. The <code>name</code> string is used to reference the origin of the data in error messages.</p></dd></dl></section><section><header><h3 id="creating-buffers-with-a-custom-preprocessor"><a href="#creating-buffers-with-a-custom-preprocessor" class="anchor"></a>Creating buffers with a custom preprocessor</h3></header><dl><dt class="spec exception" id="exception-Preprocessor_error"><a href="#exception-Preprocessor_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Preprocessor_error</span> <span class="keyword">of</span> string * string</code></dt><dd><p>Exception that can be raised by a preprocessor in case of error. The first string references the name of the buffer (e.g. the name of the corresponding file) and the second string contains the message.</p></dd></dl><dl><dt class="spec value" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>pp_error name msg</code> raises <code>Preprocessor_error(name,msg)</code>.</p></dd></dl><dl><dt class="spec module-type" id="module-type-Preprocessor"><a href="#module-type-Preprocessor" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Preprocessor/index.html">Preprocessor</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Specification of a preprocessor.</p></dd></dl><dl><dt class="spec module" id="module-WithPP"><a href="#module-WithPP" class="anchor"></a><code><span class="keyword">module</span> <a href="WithPP/index.html">WithPP</a> : <span class="keyword">functor</span> (<a href="WithPP/argument-1-PP/index.html">PP</a> : <a href="index.html#module-type-Preprocessor">Preprocessor</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Functor for building buffers with a preprocessor.</p></dd></dl></section><section><header><h3 id="buffer-manipulation-functions"><a href="#buffer-manipulation-functions" class="anchor"></a>Buffer manipulation functions</h3></header><dl><dt class="spec value" id="val-is_empty"><a href="#val-is_empty" class="anchor"></a><code><span class="keyword">val</span> is_empty : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p><code>is_empty buf</code> test whether the buffer <code>buf</code> is empty.</p></dd></dl><dl><dt class="spec value" id="val-line_num"><a href="#val-line_num" class="anchor"></a><code><span class="keyword">val</span> line_num : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>line_num buf</code> returns the current line number of <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-line_offset"><a href="#val-line_offset" class="anchor"></a><code><span class="keyword">val</span> line_offset : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>line_beginning buf</code> returns the offset of the current line in the buffer <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-line"><a href="#val-line" class="anchor"></a><code><span class="keyword">val</span> line : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>line buf</code> returns the current line in the buffer <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-line_length"><a href="#val-line_length" class="anchor"></a><code><span class="keyword">val</span> line_length : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>line_length buf</code> returns the length of the current line in the buffer <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-utf8_col_num"><a href="#val-utf8_col_num" class="anchor"></a><code><span class="keyword">val</span> utf8_col_num : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p><code>utf8_col_num buf pos</code> returns the utf8 column number corresponding to the position <code>pos</code> in <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-normalize"><a href="#val-normalize" class="anchor"></a><code><span class="keyword">val</span> normalize : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a> * int</code></dt><dd><p><code>normalize buf pos</code> ensures that <code>pos</code> is less than the length of the current line in <code>str</code>.</p></dd></dl><dl><dt class="spec value" id="val-filename"><a href="#val-filename" class="anchor"></a><code><span class="keyword">val</span> filename : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>filename buf</code> returns the file name associated to the <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-buffer_uid"><a href="#val-buffer_uid" class="anchor"></a><code><span class="keyword">val</span> buffer_uid : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>buffer_uid buf</code> returns a unique identifier for <code>buf</code>.</p></dd></dl><dl><dt class="spec value" id="val-buffer_equal"><a href="#val-buffer_equal" class="anchor"></a><code><span class="keyword">val</span> buffer_equal : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>buffer_eq b1 b2</code> tests the equality of <code>b1</code> and <code>b2</code>.</p></dd></dl><dl><dt class="spec value" id="val-buffer_compare"><a href="#val-buffer_compare" class="anchor"></a><code><span class="keyword">val</span> buffer_compare : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>buffer_compare b1 b2</code> compares <code>b1</code> and <code>b2</code>.</p></dd></dl><dl><dt class="spec value" id="val-buffer_before"><a href="#val-buffer_before" class="anchor"></a><code><span class="keyword">val</span> buffer_before : <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p><code>leq_bug b1 i1 b2 i2</code> returns true if the position <code>b1, i1</code> is before <code>b2, i2</code>. Gives meaningless result if <code>b1</code> and <code>b2</code> do not refer to the same file.</p></dd></dl><aside><p>....</p></aside><aside><p>First kind of table: association list in file order (first position in the beginning</p></aside><div class="spec module" id="module-OrdTbl"><a href="#module-OrdTbl" class="anchor"></a><code><span class="keyword">module</span> <a href="OrdTbl/index.html">OrdTbl</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec module" id="module-Tbl"><a href="#module-Tbl" class="anchor"></a><code><span class="keyword">module</span> <a href="Tbl/index.html">Tbl</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Second kind of table: unordered, but imperative and more efficient</p></dd></dl></section></div></body></html>